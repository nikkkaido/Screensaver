<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <title></title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  
  </head>
  <body>
   <!-- <label for="cityInput">Enter a city:</label>
    <input type="text" id="cityInput">
    <button id="getWeatherButton">Get Weather</button>
    <br>-->
    <div class="weather-container">

      <div class="fontpers">
        <img class="imgpers" width="80px" id="icon" src="" alt="Weather Icon"> <span class="fontpers" id="temperature"></span>Â°C
      </div>

    </div>
  
  </body>
</html>


<script>

  function getWeather() {

    $(document).ready(function() {
    const iconMap = {
      "1000": "ICONS/Sol.png",
      "1003": "ICONS/SolNube.png",
      "1006": "ICONS/Nube.png",
      "1009": "ICONS/Nubes.png",
      "1030": "ICONS/Nube.png",
      "1063": "ICONS/Nube lluvia.png",
      "1066": "ICONS/Nube Nieve.png",
      "1069": "ICONS/Nube Nieve.png",
      "1072": "ICONS/Nube lluvia.png",
      "1087": "ICONS/Nubes Rayo.png",
      "1114": "ICONS/Nieve.png",
      "1117": "ICONS/Nube Nieve.png",
      "1135": "ICONS/Nubes.png",
      "1147": "ICONS/Nubes.png",
      "1150": "ICONS/Nube Chubascos.png",
      "1153": "ICONS/Nube Lluvia.png",
      "1168": "ICONS/Nube Lluvia.png",
      "1171": "ICONS/Nube Lluvia.png",
      "1180": "ICONS/Nube Lluvia.png",
      "1183": "ICONS/Nube Lluvia.png",
      "1186": "ICONS/Nube Lluvia.png",
      "1189": "ICONS/Nube Lluvia.png",
      "1192": "ICONS/Nube Lluvia.png",
      "1195": "ICONS/Nube Lluvia 1.png",
      "1198": "ICONS/Nube Nieve 1.png",
      "1201": "ICONS/Nube Nieve 1.png",
      "1204": "ICONS/Nube Nieve 1.png",
      "1207": "ICONS/Nube Nieve 1.png",
      "1210": "ICONS/Nube Nieve 1.png",
      "1213": "ICONS/Nube Nieve 2.png",
      "1216": "ICONS/Nieve.png",
      "1219": "ICONS/Nube Nieve 1.png",
      "1222": "ICONS/Nieve.png",
      "1225": "ICONS/Nieve.png",
      "1237": "ICONS/Nieve.png",
      "1240": "ICONS/Nube Lluvia 1.png",
      "1243": "ICONS/Nube Lluvia 1.png",
      "1246": "ICONS/Nube Lluvia 1.png",
      "1249": "ICONS/Nube Lluvia 1.png",
      "1252": "ICONS/Nube Nieve.png",
      "1255": "ICONS/Nube Nieve.png",
      "1258": "ICONS/Nube Nieve.png",
      "1261": "ICONS/Nube Nieve.png",
      "1264": "ICONS/Nube Nieve.png",
      "1273": "ICONS/Nubes Rayo 1.png",
      "1276": "ICONS/Nube Rayo.png",
      "1279": "ICONS/Nube Rayo.png",
      "1282": "ICONS/Nube Rayo.png",
    };

      //INPUT CIUDAD
      var url = new URL(window.location.href);
      var q = url.searchParams.get("q");
      //var urltest = 'https://cpo.cuy.cl/originals/screensaver/clima.html?q=Santiago'
      
      const apiUrl = `http://api.weatherapi.com/v1/current.json?key=80fce66a71c141348f444201230705&q=${q}&aqi=no`;

      $.ajax({
        url: apiUrl,
        success: function(data) {
          $("#temperature").html(data.current.temp_c);
          $("#description").html(data.current.condition.text);
          $("#city").html(data.location.name);
          console.log(data.current.condition.code);
          const conditionCode = data.current.condition.code;
          const iconUrl = iconMap[conditionCode];
          $("#icon").attr("src", `${iconUrl}`);
        },
        error: function() {
          alert("Error getting weather data");
        }
      });
    });
    setTimeout(getWeather, 300000);

  }
  window.onload = getWeather;

</script>